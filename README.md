# PRS-Bridge


PRS-Bridge is a python-based command line for developing polygenic risk score (PRS) under Bridge prior using GWAS summary statistics and external LD reference data.

## Getting Started
 - Download or clone this GitHub repository by:
    `git clone https://github.com/YuzhengDun1999/PRSBridge.git`
 - Build Cython files from the root directory with:
    `~~python setup.py build_ext --inplace`
 -~~ Download LD reference data
  To be uploaded

## Using PRS-Bridge
`
python PRSBridge.py --chr --alpha --percent --ref --sumdat --h2 --h2_se --method --output 
`
 - alpha (required): Exponent of Bridge prior. It controls the sparsity level. Smaller value corresponding to sparser assumption. Suggested value for tuning parameters: 0.125, 0.25, 0.5. It can be estimated within MCMC by setting it to 'auto'.
 - chr (required): The chromosome on which the model is fitted.
 - percent (required): Percent of eigenvalues ignored in LD matrix, suggested values: 0.2, 0.4, 0.6, 0.8.
 - ref (required): Full path to the LD reference data.
 - sumstat (required): Full path and the file name of the GWAS summary statistics. The input file must have the following format (including the header line):
 ```
    SNP          A1   A2   BETA      SE      N
    rs7291672    G    A    0.00324   0.0046  811710
    rs9605903    C    T    0.00104   0.0021  808524
    rs5746647    T    G    0.00167   0.0039  859128
    ...
```
 - h2 (required): Heritability of the total chromosome. It can be estimated from other software such as LD score regression. If you do not have any guess, please take 0 as input.
 - h2_se (required): Standard error of estimated heritability of the total chromosome. It can be estimated from other software such as LD score regression. If you do not have any guess, please take 0 as input.
 - method (required): Method to sample from multi-variate normal distribution. For now, it support 'cg' and 'cholesky'. 'cg' uses prior-preconditioned conjugate gradient method. 'cholesky' uses traditional cholesky decomposition. 'cg' is faster than 'cholesky'.
 - output (required): Location of output files.

## Output

PRS-Bridge writes posterior SNP effect size estimates for each chromosome to the user-specified directory. The output file contains rsid, A1, A2 and posterior effect size estimate for each SNP. An individual-level polygenic score can be produced by concatenating output files from all chromosomes and then using `PLINK`'s `--score` command (https://www.cog-genomics.org/plink/1.9/score). If polygenic scores are generated by chromosome, use the 'sum' modifier so that they can be combined into a genome-wide score.

## Test Data

The test data contains GWAS summary statistics for 500 SNPs on chromosome 22.
An example to use the test data:
`
python PRSBridge.py --percent 0.2 --chr 22 --alpha 0.125 --ref path_to_ref/chr --sumdat path_to_sumstats/sumstat.txt --h2 0 --h2_se 0 --method cg --output path_to_output
`
## Support

Please direct any problems or questions to Yuzheng Dun (ydun2@jhu.edu).

  

## Citation

Dun, Yuzheng, et al. "A Robust Bayesian Method for Building Polygenic Risk Scores using Projected Summary Statistics and Bridge Prior." arXiv preprint arXiv:2401.15014 (2024). (https://arxiv.org/abs/2401.15014)
